<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruthoria Brand Invoice Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .form-container {
            flex-basis: 50%;
            padding: 2rem;
        }
        .invoice-preview-container {
            flex-basis: 50%;
            padding: 2rem;
            min-width: 50%;
        }
        .invoice-box {
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            background-color: #fff;
            padding: 2rem;
        }
        .royal-pink {
            background-color: #FFC0CB;
        }
        .royal-pink-text {
            color: #FFC0CB;
        }
        .royal-gradient-pink {
            background: linear-gradient(to right, #FFC0CB, #E6A8D7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .form-container, .print-hidden {
                display: none;
            }
            .invoice-preview-container {
                width: 100%;
                flex-basis: 100%;
                padding: 0;
            }
            .invoice-box {
                box-shadow: none;
                padding: 1rem;
            }
        }
    </style>
</head>
<body class="bg-gray-100 p-4 md:p-8">
    <div class="max-w-7xl mx-auto flex flex-col md:flex-row gap-8 bg-white rounded-xl shadow-lg">
        <!-- Form Input Section -->
        <div class="form-container">
            <h1 class="text-3xl font-bold text-gray-800 mb-6">Create New Invoice</h1>
            <form id="invoice-form">
                <!-- Customer Details -->
                <div class="space-y-4 mb-8 p-4 bg-gray-50 rounded-lg">
                    <h2 class="text-xl font-semibold text-gray-700">Customer Details</h2>
                    <div>
                        <label for="customer-name" class="block text-sm font-medium text-gray-700">Customer Name</label>
                        <input type="text" id="customer-name" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-royal-pink focus:ring-royal-pink sm:text-sm p-2" placeholder="Jane Doe">
                    </div>
                    <div>
                        <label for="customer-email" class="block text-sm font-medium text-gray-700">Phone / Email</label>
                        <input type="text" id="customer-email" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-royal-pink focus:ring-royal-pink sm:text-sm p-2" placeholder="+123456789 / jane.doe@example.com">
                    </div>
                    <div>
                        <label for="customer-address" class="block text-sm font-medium text-gray-700">Customer Address</label>
                        <textarea id="customer-address" rows="2" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-royal-pink focus:ring-royal-pink sm:text-sm p-2" placeholder="123 Main St, Anytown, USA"></textarea>
                    </div>
                    <div>
                        <label for="invoice-date" class="block text-sm font-medium text-gray-700">Date</label>
                        <input type="date" id="invoice-date" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-royal-pink focus:ring-royal-pink sm:text-sm p-2">
                    </div>
                </div>

                <!-- Items Section -->
                <div class="space-y-4 mb-8 p-4 bg-gray-50 rounded-lg">
                    <h2 class="text-xl font-semibold text-gray-700">Items</h2>
                    <div id="item-list" class="space-y-4">
                        <!-- Dynamic item rows will be added here -->
                        <div class="item-row flex flex-col md:flex-row gap-2 items-center">
                            <input type="text" class="item-desc w-full md:w-3/5 rounded-md border-gray-300 shadow-sm focus:border-royal-pink focus:ring-royal-pink sm:text-sm p-2" placeholder="Description">
                            <input type="number" class="item-qty w-full md:w-1/5 rounded-md border-gray-300 shadow-sm focus:border-royal-pink focus:ring-royal-pink sm:text-sm p-2" value="1" min="1">
                            <input type="number" step="0.01" class="item-price w-full md:w-1/5 rounded-md border-gray-300 shadow-sm focus:border-royal-pink focus:ring-royal-pink sm:text-sm p-2" placeholder="Price (₦)">
                            <button type="button" class="remove-item text-gray-400 hover:text-red-500 transition-colors duration-200">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <button type="button" id="add-item" class="w-full text-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-royal-pink hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-royal-pink transition-all duration-200">
                        Add Item
                    </button>
                </div>

                <!-- Payment & Notes -->
                <div class="space-y-4 p-4 bg-gray-50 rounded-lg">
                    <h2 class="text-xl font-semibold text-gray-700">Payment & Notes</h2>
                    <div>
                        <label for="payment-details" class="block text-sm font-medium text-gray-700">Payment Details</label>
                        <textarea id="payment-details" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-royal-pink focus:ring-royal-pink sm:text-sm p-2" placeholder="Bank info, transaction ID, etc."></textarea>
                    </div>
                    <div>
                        <label for="notes" class="block text-sm font-medium text-gray-700">Notes</label>
                        <textarea id="notes" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-royal-pink focus:ring-royal-pink sm:text-sm p-2" placeholder="Optional notes..."></textarea>
                    </div>
                </div>
            </form>
        </div>

        <!-- Receipt/Invoice Preview -->
        <div class="invoice-preview-container bg-white rounded-r-xl">
            <div id="invoice-preview" class="invoice-box p-8 w-full max-w-2xl mx-auto rounded-lg">
                <!-- Branding & Invoice Info -->
                <div class="flex justify-between items-center mb-10">
                    <div>
                        <h1 class="text-4xl font-extrabold royal-gradient-pink">Ruthoria Brand</h1>
                        <p class="text-sm text-gray-500 mt-2">
                            Email: ruthoriabrand@gmail.com<br>
                            Phone: +2347041852461
                        </p>
                    </div>
                    <div class="text-right">
                        <h2 class="text-2xl font-bold text-gray-800">INVOICE</h2>
                        <p class="text-sm text-gray-600 mt-2">
                            Invoice #: <span id="invoice-number">#INV-0001</span><br>
                            Date: <span id="preview-date">September 4, 2025</span>
                        </p>
                    </div>
                </div>

                <!-- Customer Details -->
                <div class="mb-10">
                    <p class="text-sm font-semibold text-gray-800">Bill To:</p>
                    <p id="preview-customer-name" class="text-lg font-bold text-gray-700">Jane Doe</p>
                    <p id="preview-customer-contact" class="text-sm text-gray-600">jane.doe@example.com</p>
                    <p id="preview-customer-address" class="text-sm text-gray-600">123 Main St, Anytown, USA</p>
                </div>

                <!-- Items Table -->
                <div class="mb-10">
                    <div class="flex items-center bg-gray-50 p-3 font-semibold text-sm text-gray-700 rounded-md">
                        <span class="w-1/2">Description</span>
                        <span class="w-1/6 text-center">Qty</span>
                        <span class="w-1/6 text-right">Price</span>
                        <span class="w-1/6 text-right">Total</span>
                    </div>
                    <div id="preview-item-list" class="mt-2 space-y-2">
                        <!-- Preview items will be rendered here -->
                    </div>
                </div>

                <!-- Totals -->
                <div class="flex justify-end">
                    <div class="w-full md:w-1/2">
                        <div class="flex justify-between items-center py-2 border-b border-gray-200">
                            <span class="text-gray-700">Subtotal:</span>
                            <span id="preview-subtotal" class="font-semibold">₦0.00</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-gray-200">
                            <span class="text-gray-700">Tax (0%):</span>
                            <span id="preview-tax" class="font-semibold">₦0.00</span>
                        </div>
                        <div class="flex justify-between items-center py-2 font-bold text-xl royal-gradient-pink">
                            <span>Grand Total:</span>
                            <span id="preview-grand-total">₦0.00</span>
                        </div>
                    </div>
                </div>

                <!-- Payment Details & Notes -->
                <div class="mt-10 pt-4 border-t border-gray-200">
                    <p class="text-sm text-gray-600 mb-2">
                        <span class="font-semibold text-gray-800">Payment Details:</span><br>
                        <span id="preview-payment-details"></span>
                    </p>
                    <p class="text-sm text-gray-600 mb-2">
                        <span class="font-semibold text-gray-800">Notes:</span><br>
                        <span id="preview-notes"></span>
                    </p>
                    <p class="text-sm text-gray-600 mt-6">
                        <span class="font-bold text-gray-800">Payment should be made 7 days before delivery.</span>
                    </p>
                </div>
            </div>
            <!-- Action buttons -->
            <div class="flex justify-center gap-4 mt-8 print-hidden">
                <button id="download-pdf" class="py-2 px-4 rounded-md shadow-lg text-sm font-medium text-white bg-royal-pink hover:opacity-90 transition-all duration-200">
                    Download PDF
                </button>
                <button id="print-receipt" class="py-2 px-4 rounded-md shadow-lg text-sm font-medium text-gray-700 bg-gray-200 hover:bg-gray-300 transition-all duration-200">
                    Print
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('invoice-form');
            const itemList = document.getElementById('item-list');
            const addItemBtn = document.getElementById('add-item');
            const downloadPdfBtn = document.getElementById('download-pdf');
            const printReceiptBtn = document.getElementById('print-receipt');
            
            // Preview elements
            const previewCustomerName = document.getElementById('preview-customer-name');
            const previewCustomerContact = document.getElementById('preview-customer-contact');
            const previewCustomerAddress = document.getElementById('preview-customer-address');
            const previewDate = document.getElementById('preview-date');
            const previewItemList = document.getElementById('preview-item-list');
            const previewSubtotal = document.getElementById('preview-subtotal');
            const previewTax = document.getElementById('preview-tax');
            const previewGrandTotal = document.getElementById('preview-grand-total');
            const previewPaymentDetails = document.getElementById('preview-payment-details');
            const previewNotes = document.getElementById('preview-notes');
            const invoiceNumber = document.getElementById('invoice-number');
            const invoiceDateInput = document.getElementById('invoice-date');

            let invoiceCounter = localStorage.getItem('invoiceCounter') || 1;

            const generateInvoiceNumber = () => {
                const number = String(invoiceCounter).padStart(4, '0');
                invoiceNumber.textContent = `#INV-${number}`;
            };
            
            const updatePreview = () => {
                const customerName = document.getElementById('customer-name').value;
                const customerContact = document.getElementById('customer-email').value;
                const customerAddress = document.getElementById('customer-address').value;
                const invoiceDate = invoiceDateInput.value;
                const paymentDetails = document.getElementById('payment-details').value;
                const notes = document.getElementById('notes').value;

                previewCustomerName.textContent = customerName || 'Jane Doe';
                previewCustomerContact.textContent = customerContact || 'jane.doe@example.com';
                previewCustomerAddress.textContent = customerAddress || '123 Main St, Anytown, USA';
                previewDate.textContent = new Date(invoiceDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                previewPaymentDetails.textContent = paymentDetails || 'N/A';
                previewNotes.textContent = notes || 'N/A';

                updateTotals();
            };

            const updateTotals = () => {
                let subtotal = 0;
                previewItemList.innerHTML = ''; // Clear existing items

                const itemRows = document.querySelectorAll('.item-row');
                if (itemRows.length === 0) {
                    // Render a placeholder if no items exist
                    const emptyItemRow = document.createElement('div');
                    emptyItemRow.innerHTML = `<p class="text-sm text-gray-500 text-center">No items added.</p>`;
                    previewItemList.appendChild(emptyItemRow);
                } else {
                    itemRows.forEach(row => {
                        const description = row.querySelector('.item-desc').value;
                        const qty = parseFloat(row.querySelector('.item-qty').value) || 0;
                        const price = parseFloat(row.querySelector('.item-price').value) || 0;
                        const total = qty * price;
                        subtotal += total;

                        const previewRow = document.createElement('div');
                        previewRow.classList.add('flex', 'items-center', 'text-sm', 'text-gray-800', 'py-2', 'border-b', 'border-gray-100');
                        previewRow.innerHTML = `
                            <span class="w-1/2">${description || 'Item Description'}</span>
                            <span class="w-1/6 text-center">${qty}</span>
                            <span class="w-1/6 text-right">₦${price.toFixed(2)}</span>
                            <span class="w-1/6 text-right">₦${total.toFixed(2)}</span>
                        `;
                        previewItemList.appendChild(previewRow);
                    });
                }
                
                const taxRate = 0;
                const tax = subtotal * taxRate;
                const grandTotal = subtotal + tax;

                previewSubtotal.textContent = `₦${subtotal.toFixed(2)}`;
                previewTax.textContent = `₦${tax.toFixed(2)}`;
                previewGrandTotal.textContent = `₦${grandTotal.toFixed(2)}`;
            };

            const addNewItemRow = () => {
                const newRow = document.createElement('div');
                newRow.classList.add('item-row', 'flex', 'flex-col', 'md:flex-row', 'gap-2', 'items-center');
                newRow.innerHTML = `
                    <input type="text" class="item-desc w-full md:w-3/5 rounded-md border-gray-300 shadow-sm focus:border-royal-pink focus:ring-royal-pink sm:text-sm p-2" placeholder="Description">
                    <input type="number" class="item-qty w-full md:w-1/5 rounded-md border-gray-300 shadow-sm focus:border-royal-pink focus:ring-royal-pink sm:text-sm p-2" value="1" min="1">
                    <input type="number" step="0.01" class="item-price w-full md:w-1/5 rounded-md border-gray-300 shadow-sm focus:border-royal-pink focus:ring-royal-pink sm:text-sm p-2" placeholder="Price (₦)">
                    <button type="button" class="remove-item text-gray-400 hover:text-red-500 transition-colors duration-200">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                        </svg>
                    </button>
                `;
                itemList.appendChild(newRow);
                updatePreview();
            };

            const setInitialDate = () => {
                const today = new Date();
                const year = today.getFullYear();
                const month = String(today.getMonth() + 1).padStart(2, '0');
                const day = String(today.getDate()).padStart(2, '0');
                invoiceDateInput.value = `${year}-${month}-${day}`;
            };

            // Event Listeners
            addItemBtn.addEventListener('click', addNewItemRow);
            itemList.addEventListener('click', (e) => {
                if (e.target.closest('.remove-item')) {
                    e.target.closest('.item-row').remove();
                    updatePreview();
                }
            });

            form.addEventListener('input', updatePreview);

            downloadPdfBtn.addEventListener('click', () => {
                const element = document.getElementById('invoice-preview');
                const opt = {
                    margin: 1,
                    filename: `invoice-${invoiceNumber.textContent}.pdf`,
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { scale: 2 },
                    jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
                };
                html2pdf().from(element).set(opt).save();

                invoiceCounter++;
                localStorage.setItem('invoiceCounter', invoiceCounter);
                generateInvoiceNumber();
            });

            printReceiptBtn.addEventListener('click', () => {
                window.print();
            });

            // Initial setup
            setInitialDate();
            generateInvoiceNumber();
            updatePreview();
            
        });
    </script>
</body>
</html>

